{"version":3,"file":"forum.js","mappings":"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","sources":["webpack://@clarkwinkelmann/vote-with-money/webpack/bootstrap","webpack://@clarkwinkelmann/vote-with-money/webpack/runtime/compat get default export","webpack://@clarkwinkelmann/vote-with-money/webpack/runtime/define property getters","webpack://@clarkwinkelmann/vote-with-money/webpack/runtime/hasOwnProperty shorthand","webpack://@clarkwinkelmann/vote-with-money/webpack/runtime/make namespace object","webpack://@clarkwinkelmann/vote-with-money/external root \"flarum.core.compat['common/extend']\"","webpack://@clarkwinkelmann/vote-with-money/external root \"flarum.core.compat['forum/app']\"","webpack://@clarkwinkelmann/vote-with-money/external root \"flarum.core.compat['common/components/Switch']\"","webpack://@clarkwinkelmann/vote-with-money/external root \"flarum.core.compat['common/Model']\"","webpack://@clarkwinkelmann/vote-with-money/external root \"flarum.core.compat['common/utils/withAttr']\"","webpack://@clarkwinkelmann/vote-with-money/./node_modules/@babel/runtime/helpers/esm/setPrototypeOf.js","webpack://@clarkwinkelmann/vote-with-money/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@clarkwinkelmann/vote-with-money/external root \"flarum.core.compat['common/Component']\"","webpack://@clarkwinkelmann/vote-with-money/./src/forum/components/FormattedMoney.ts","webpack://@clarkwinkelmann/vote-with-money/external root \"flarum.core.compat['common/components/Modal']\"","webpack://@clarkwinkelmann/vote-with-money/external root \"flarum.core.compat['common/components/Button']\"","webpack://@clarkwinkelmann/vote-with-money/./src/forum/components/VoteModal.ts","webpack://@clarkwinkelmann/vote-with-money/./src/forum/index.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/extend'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['forum/app'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Switch'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Model'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/utils/withAttr'];","export default function _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}","import setPrototypeOf from \"./setPrototypeOf.js\";\nexport default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  setPrototypeOf(subClass, superClass);\n}","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/Component'];","import app from 'flarum/forum/app';\nimport Component, {ComponentAttrs} from 'flarum/common/Component';\n\ninterface MoneyFormatAttrs extends ComponentAttrs {\n    money: number\n}\n\nexport default class FormattedMoney extends Component<MoneyFormatAttrs> {\n    view() {\n        const moneyName = app.forum.attribute<string>('antoinefr-money.moneyname') || '[money]';\n\n        return m('span', moneyName.replace('[money]', this.attrs.money + ''));\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Modal'];","const __WEBPACK_NAMESPACE_OBJECT__ = flarum.core.compat['common/components/Button'];","import app from 'flarum/forum/app';\nimport Modal, {IInternalModalAttrs} from 'flarum/common/components/Modal';\nimport Button from 'flarum/common/components/Button';\nimport {ApiPayloadSingle} from 'flarum/common/Store';\nimport Model from 'flarum/common/Model';\nimport FormattedMoney from './FormattedMoney';\n\ninterface VoteModalAttrs extends IInternalModalAttrs {\n    // We don't have type-hints available for Poll or PollOption\n    poll: Model\n    option: Model\n    onsubmit: () => void\n}\n\nexport default class VoteModal extends Modal<VoteModalAttrs> {\n    preselectAmount: number = 0\n    customAmount: boolean = false\n    customAmountValue: string = ''\n\n    oninit(vnode: any) {\n        super.oninit(vnode);\n\n        if ((app.forum.attribute<string[]>('moneyVotePreselection') || []).length === 0) {\n            this.customAmount = true;\n        }\n    }\n\n    className() {\n        return 'MoneyPollVoteModal Modal--small';\n    }\n\n    title() {\n        return app.translator.trans('clarkwinkelmann-vote-with-money.forum.vote.title');\n    }\n\n    content() {\n        const preselection = app.forum.attribute<string[]>('moneyVotePreselection') || [];\n\n        return m('.Modal-body', [\n            m('.Form-group', [\n                app.translator.trans('clarkwinkelmann-vote-with-money.forum.vote.target', {\n                    answer: this.attrs.option.attribute('answer'),\n                }),\n            ]),\n            preselection.length > 0 ? m('.Form-group', [\n                preselection.map((amount, index) => {\n                    return m('label', [\n                        m('input', {\n                            type: 'radio',\n                            name: 'vote-with-money-preselection',\n                            checked: this.preselectAmount === index && !this.customAmount,\n                            onchange: () => {\n                                this.preselectAmount = index;\n                                this.customAmount = false;\n                            },\n                        }),\n                        ' ',\n                        FormattedMoney.component({\n                            money: amount,\n                        }),\n                    ]);\n                }),\n                m('label', [\n                    m('input', {\n                        type: 'radio',\n                        name: 'vote-with-money-preselection',\n                        checked: this.customAmount,\n                        onchange: () => {\n                            this.customAmount = true;\n                        },\n                    }),\n                    ' ',\n                    app.translator.trans('clarkwinkelmann-vote-with-money.forum.vote.optionCustom'),\n                ]),\n            ]) : null,\n            this.customAmount ? m('.Form-group', [\n                m('label', app.translator.trans('clarkwinkelmann-vote-with-money.forum.vote.label.custom')),\n                m('input.FormControl', {\n                    type: 'number',\n                    value: this.customAmountValue,\n                    onchange: (event: InputEvent) => {\n                        this.customAmountValue = (event.target as HTMLInputElement).value;\n                    },\n                    min: this.attrs.poll.attribute('moneyVoteMin'),\n                    max: this.attrs.poll.attribute('moneyVoteMax') || undefined,\n                    step: 1,\n                }),\n            ]) : '',\n            m('.Form-group', [\n                app.translator.trans('clarkwinkelmann-vote-with-money.forum.vote.balance', {\n                    amount: FormattedMoney.component({\n                        money: app.session.user!.attribute('money'),\n                    }),\n                }),\n            ]),\n            m('.Form-group', Button.component({\n                type: 'submit',\n                className: 'Button Button--primary',\n                loading: this.loading,\n            }, app.translator.trans('clarkwinkelmann-vote-with-money.forum.vote.submit'))),\n        ]);\n    }\n\n    onsubmit(event: Event) {\n        event.preventDefault();\n\n        this.loading = true;\n\n        // Same API call as in DiscussionPoll.changeVote\n        app.request<ApiPayloadSingle>({\n            method: 'PATCH',\n            url: `${app.forum.attribute('apiUrl')}/fof/polls/${this.attrs.poll.id()}/vote`,\n            errorHandler: this.onerror.bind(this),\n            body: {\n                data: {\n                    optionId: this.attrs.option.id(),\n                    amountPledged: this.customAmount ? this.customAmountValue : app.forum.attribute<string[]>('moneyVotePreselection')[this.preselectAmount],\n                },\n            },\n        })\n            .then(payload => {\n                app.store.pushPayload(payload);\n\n                this.hide();\n                this.attrs.onsubmit();\n            })\n            .catch(() => {\n                this.loading = false;\n                m.redraw();\n            });\n    }\n}\n","import {extend, override} from 'flarum/common/extend';\nimport app from 'flarum/forum/app';\nimport Switch from 'flarum/common/components/Switch';\nimport Model from 'flarum/common/Model';\nimport withAttr from 'flarum/common/utils/withAttr';\nimport FormattedMoney from './components/FormattedMoney';\nimport VoteModal from './components/VoteModal';\n\napp.initializers.add('clarkwinkelmann-vote-with-money', () => {\n    const {components} = flarum.extensions['fof-polls'] as any;\n\n    // Capture vote intent and open special modal to confirm pledge amount\n    override(components.DiscussionPoll.prototype, 'changeVote', function (original, option, evt: InputEvent) {\n        if (!app.session.user || !this.poll.attribute('voteWithMoney')) {\n            return original(option, evt);\n        }\n\n        app.modal.show(VoteModal, {\n            poll: this.poll,\n            option,\n            onsubmit: () => {\n                // Same logic as in DiscussionPoll.changeVote\n                this.updateData();\n\n                m.redraw();\n\n                // Additional alert to improve UX\n                app.alerts.show({type: 'success'}, app.translator.trans('clarkwinkelmann-vote-with-money.forum.vote.success'));\n            },\n        });\n        (evt.target as HTMLInputElement).checked = false;\n    });\n\n    extend(components.CreatePollModal.prototype, 'oninit', function (items) {\n        const {poll} = this.attrs;\n\n        if (poll) {\n            if (poll instanceof Model) {\n                // In EditPollModel the poll will be a model\n                this.voteWithMoney = poll.attribute('voteWithMoney');\n                this.moneyVoteMin = poll.attribute('moneyVoteMin') + '';\n                this.moneyVoteMax = poll.attribute('moneyVoteMax') + '';\n            } else {\n                // In CreatePollModal the poll will be the save data POJO\n                this.voteWithMoney = poll.voteWithMoney;\n                this.moneyVoteMin = poll.moneyVoteMin + '';\n                this.moneyVoteMax = poll.moneyVoteMax + '';\n            }\n        }\n\n        if (!this.moneyVoteMin && this.moneyVoteMin !== '0') {\n            this.moneyVoteMin = '';\n        }\n        if (!this.moneyVoteMax && this.moneyVoteMax !== '0') {\n            this.moneyVoteMax = '';\n        }\n    });\n\n    extend(components.CreatePollModal.prototype, 'fields', function (items) {\n        items.add('vote-with-money', m('.Form-group', Switch.component({\n            state: !!this.voteWithMoney,\n            onchange: (state: boolean) => {\n                this.voteWithMoney = state;\n            },\n        }, app.translator.trans('clarkwinkelmann-vote-with-money.forum.poll.voteWithMoney'))));\n\n        if (this.voteWithMoney) {\n            items.add('vote-with-money-min', m('.Form-group', [\n                m('label.label', app.translator.trans('clarkwinkelmann-vote-with-money.forum.poll.min')),\n                m('input.FormControl', {\n                    type: 'number',\n                    min: 0,\n                    step: 1,\n                    value: this.moneyVoteMin,\n                    onchange: withAttr('value', (value: string) => {\n                        this.moneyVoteMin = value;\n                    }),\n                }),\n            ]));\n\n            items.add('vote-with-money-max', m('.Form-group', [\n                m('label.label', app.translator.trans('clarkwinkelmann-vote-with-money.forum.poll.max')),\n                m('input.FormControl', {\n                    type: 'number',\n                    min: 0,\n                    step: 1,\n                    value: this.moneyVoteMax,\n                    onchange: withAttr('value', (value: string) => {\n                        this.moneyVoteMax = value;\n                    }),\n                }),\n            ]));\n        }\n    });\n\n    function pollModalData(this: any, data: any) {\n        if (data === null) {\n            return;\n        }\n\n        data.voteWithMoney = this.voteWithMoney;\n        data.moneyVoteMin = this.moneyVoteMin === '' ? null : this.moneyVoteMin;\n        data.moneyVoteMax = this.moneyVoteMax === '' ? null : this.moneyVoteMax;\n    }\n\n    // Add data to submit. We need to extend both modals separately because despite extending each other they don't call parent\n    extend(components.CreatePollModal.prototype, 'data', pollModalData);\n    extend(components.EditPollModal.prototype, 'data', pollModalData);\n\n    // Add className so our CSS can apply only to money poll voters\n    override(components.ListVotersModal.prototype, 'className', function (override) {\n        let className: string = override();\n\n        if (this.attrs.poll.attribute('voteWithMoney')) {\n            className += ' VotesModal--withMoneyPledges';\n        }\n\n        return className;\n    });\n\n    // Add pledge indicator next to voters\n    extend(components.ListVotersModal.prototype, 'voteContent', function (vdom, vote: any) {\n        if (!this.attrs.poll.attribute('voteWithMoney')) {\n            return;\n        }\n\n        vdom.children.push(m('span.moneyPledged', FormattedMoney.component({\n            money: vote.attribute('moneyPledged') || 0,\n        })));\n    });\n\n});\n"],"names":["__webpack_require__","module","getter","__esModule","d","a","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","flarum","core","compat","_setPrototypeOf","p","setPrototypeOf","bind","__proto__","_inheritsLoose","subClass","superClass","create","constructor","FormattedMoney","view","moneyName","app","m","replace","this","attrs","money","Component","VoteModal","preselectAmount","customAmount","customAmountValue","oninit","vnode","length","className","title","content","preselection","answer","option","attribute","map","amount","index","type","name","checked","onchange","component","event","target","min","poll","max","undefined","step","Button","loading","onsubmit","preventDefault","method","url","id","errorHandler","onerror","body","data","optionId","amountPledged","then","payload","hide","redraw","Modal","components","extensions","pollModalData","voteWithMoney","moneyVoteMin","moneyVoteMax","override","DiscussionPoll","original","evt","updateData","extend","CreatePollModal","items","Model","add","Switch","state","withAttr","EditPollModal","ListVotersModal","vdom","vote","children","push"],"sourceRoot":""}